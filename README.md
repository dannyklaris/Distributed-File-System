# Distributed File System
## Description
This is a repo to store all the files that is related to this project.
## Table of Contents
- [Local Validation](#local-validation)
- [How to use the provided Client](#how-to-use-the-provided-client)

## Local Validation
How to use the script to validate your submission locally

The zip includes
- bash script (validate_submission.sh)
- Java policy file (my_policy.policy)

The script will (1) unzip your submission, (2) check all required files are included, (3) compile all the Java sources, (4) run Controller and Dstores.

The script is meant to be run in a bash terminal. Make sure both the script and the Java policy file are unzipped in the same directory. You may need to make the script executable using the following command.
```
chmod +x validate_submission.sh
```


To run the script, type the following
```
./validate_submission.sh <submission.zip> <wait_time>
```

The `wait_time` parameter defines how many seconds to wait before the script terminates Controller and Dstore processes. This parameter is optional; if you don't specify it, the default value 5 will be used. You can also specify a negative value to indicate that the script must not terminate Controller and Dstore processes; this can be useful to let you use your client to test your software in a situation where Controller and Dstores are launched in the same way they will be launched for the assessment. Note that in this case you should terminate the processes manually.

When your software will be assessed, a number of tests will be executed on an Ubuntu 20 machine. To minimise the risk this machine could be disrupted by any accidental software bugs, a Security Manager is started when Controller and Dstores are launched. The operations your software is allowed to execute are defined in the Java policy file. In practice, your software is allowed to do networking activities on localhost using ports from 1025 to 65535 and handle files inside the working directory. Any operation that is not allowed would throw a java.security.AccessControlException.

Note that the Security Manager functionality is deprecated and will be removed in the future. For this reason, you will see some Security Manager warnings printed on the terminal. This is fine and does not affect your submission. For further details about the Java Security Manager, please refer to https://docs.oracle.com/en/java/javase/17/security/permissions-jdk1.html

Please read carefully the instructions displayed by the script before typing 'y'. After your submission has been compiled, a Controller and 3 Dstores will be started. During the validation, a number of messages will be printed on stdout/stderr, some generated by the script and others by your software. Please make sure all these messages correspond to what you expect your code to print.

NB: this script does not verify that the java version installed on your computer is the correct one. Please make sure you compile and run your code using Java openjdk-17-jdk, on Ubuntu 20.

## How to use the provided Client


- compilation
    - make sure client.jar and ClientMain.java are in the current diretory
    - from terminal, type:
    ```
    javac -cp client.jar ClientMain.java
    ```
    
- execution
    - on Linux - from terminal, type:
    ```
    java -cp client.jar:. ClientMain 12345 1000
    ```
    
    - on Windows - from terminal, type:
    ```
    java -cp client.jar;. ClientMain 12345 1000
    ```

## How to run the all the code
- First, you need to compile the java code.
    - `javac Controller.java`
    - `javac Dstore.java`
- Then, you start the Controller by giving parameters to it.
    - `java Controller (cport) (replication_factor) (timeout) (rebalance_period)`
        - cport means the central port for Dstore and Client to connect to Controller.
        - replication_factor means how many Dstore servers do you need. So if you put 1, you must connect at least 1, if you put 2, you must connect at least 2.
        - rebalance_period i dont remember.
    - `java Controller 1234 1 1000 1`
- Connect Dstore to the Controller.
    - `java Dstore (dstore port) (cport) (timeout) (file_folder)`
    - `java Dstore 123 1234 1000 to_store`
- Then, you compile the client.jar with the ClientMain.java.
    - `javac -cp client.jar ClientMain.java`
- Then, start the client.
    - `java -cp client.jar;. ClientMain (cport) (timeout)`
    - `java -cp client.jar;. ClientMain 1234 1000`
